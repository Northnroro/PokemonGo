function initQuota(){var t=prompt("กรุณาใส่ code"),e=0,o=0,a=!1;$.ajax({url:"https://api.myjson.com/bins/"+t,success:function(n){if(e=n.quota,!e){if(console.log("fail"),t=prompt("กรุณาใส่ code ใหม่ให้ถูกต้อง"),null==t)return;return void initQuota()}var i=5;e>i?e=i:i=e,o=n.quota-i,$.ajax({url:"https://api.myjson.com/bins/"+t,type:"PUT",data:'{"quota":'+o+"}",contentType:"application/json; charset=utf-8",dataType:"json"}),$(".scan").find("*").remove(),$(".scan").append("<center><div id='qqt' style='font-size:30px;'>"+(e+o)+"</div></center>"),map.off("click"),map.off("dblclick"),map.on("click",function(n){if(e>0){e--,$("#qqt").text(e+o);var i=n.latlng.lat,s=n.latlng.lng,r=new L.LatLng(i,s);try{marker.setLatLng(r);var l=new L.circle(r,200,{color:"red"});map.addLayer(l),getPokemon2(r.lat,r.lng,l)}catch(c){}throttledLoadCache(r)}0>=e&&($("#qqt").text("โหลด"),a||(a=!0,$.ajax({url:"https://api.myjson.com/bins/"+t,success:function(n){if(e=n.quota,!e){if(console.log("fail"),t=prompt("กรุณาใส่ code ใหม่ให้ถูกต้อง"),null==t)return;return void initQuota()}var i=5;e>i?e=i:i=e,o=n.quota-i,$.ajax({url:"https://api.myjson.com/bins/"+t,type:"PUT",data:'{"quota":'+o+"}",contentType:"application/json; charset=utf-8",dataType:"json"}),a=!1,$("#qqt").text(e+o),0==e&&(t=prompt("แต้มหมดแล้ว กรุณาร่วมกิจกรรมกับทางเพจเพื่อรับแต้มเพิ่ม\nFB: Pokemon Go Map Thailand\nยังมีโค้ดอื่นหรือ? ใส่ได้เลย"),initQuota())},statusCode:{404:function(){console.log("fail"),t=prompt("กรุณาใส่ code ใหม่ให้ถูกต้อง"),initQuota()}}})))})},statusCode:{404:function(){console.log("fail"),t=prompt("กรุณาใส่ code ใหม่ให้ถูกต้อง"),null!=t&&initQuota()}}})}function getPokemon2(t,e,o){var a=setInterval(function(){o.setStyle({color:"#300"}),setTimeout(function(){o.setStyle({color:"#700"})},250),setTimeout(function(){o.setStyle({color:"#A00"})},500),setTimeout(function(){o.setStyle({color:"#F00"})},750)},1e3);$.getJSON("https://api.fastpokemap.se/?lat="+t+"&lng="+e,function(n){if(n.error&&"overload"==n.error)return setTimeout(function(){getPokemon(t,e)},500);if(console.log("Successful scan"),status="success",$(".scan").removeClass("active").addClass(status),setTimeout(function(){$(".scan").removeClass(status)},1500),$(".nearby").html('<div style="width:100px;"><h3>0 MONSTER FOUND</h3></div>'),n&&n.result&&n.result.length>=1){var i;nFound=0,bufferRadar="";var s=!1;for(i in n.result){var r=n.result[i];void 0!=r.spawn_point_id?(r.expiration_timestamp_ms<=0&&(r.expiration_timestamp_ms=Date.now()+93e4),addPokemonToMap(r)):void 0!=r.lure_info&&(r.encounter_id=r.lure_info.encounter_id,r.pokemon_id=r.lure_info.active_pokemon_id,r.expiration_timestamp_ms=r.lure_info.lure_expires_timestamp_ms,addPokemonToMap(r)),nFound++,s=!0,bufferRadar+='<div class="pokemon"><img src="data:image/png;base64,'+pokemonPNG[PokemonIdList[r.pokemon_id]]+'" /></div>'}nFound>=1&&(oldView?$(".nearby").html(bufferRadar):$(".nearby").html('<div style="width:115px;"><h3>'+nFound+" MONSTER(S) FOUND</h3></div>"))}clearInterval(a);setInterval(function(){o.setStyle({color:"green"}),o.setRadius(o.getRadius()+2)},50);setTimeout(function(){map.removeLayer(o)},2e3),$(".nearby").show()}).fail(function(t,e){map.removeLayer(o),clearInterval(a),console.log("Scan failed"),$(".scan").prop("disabled",!1),curstatus="failed",isScanning=!1;var n=Date.now();$(".scan").data("failid",n),$(".scan").removeClass("active").addClass(curstatus),setTimeout(function(){$(".scan").data("failid")==n&&($(".scan").removeClass(curstatus),n=null)},1500)})}setInterval(function(){$(".displaypokemon").removeAttr("onclick")},200),initQuota();